image:
  file: .gitpod.Dockerfile

ports:
  - name: Chat Interface
    port: 3000
    onOpen: open-preview
    visibility: public
  - name: n8n Workflows
    port: 5678
    onOpen: open-browser
    visibility: public
  - name: PostgreSQL
    port: 5432
    onOpen: ignore
    visibility: private
  - name: Ollama API
    port: 11434
    onOpen: ignore
    visibility: private

tasks:
  - name: Setup and Start
    init: |
      echo "ğŸµ Configurando Asistente Parranda Vallenata..."
      chmod +x commands.sh
      mkdir -p nginx/ssl data logs
      echo "âœ… Entorno configurado"
    
    command: |
      echo "ğŸš€ Iniciando servicios..."
      sleep 5
      docker-compose up -d
      echo "â³ Esperando servicios (60 segundos)..."
      sleep 60
      echo "ğŸ¤– Instalando modelo de IA..."
      docker-compose exec -d ollama ollama pull llama3.1:8b
      echo "âœ… Todo listo!"
      echo "ğŸ“± Chat: $(gp url 3000)"
      echo "ğŸ”§ n8n: $(gp url 5678)"
      docker-compose ps

vscode:
  extensions:
    - ms-azuretools.vscode-docker
    - ms-vscode.vscode-json
